"use client"

import { useEffect, useRef, useState } from "react"
import { useAppDispatch, useAppSelector } from "@/lib/redux/hooks"
import { fetchCategories } from "@/lib/redux/slices/categoriesSlice"
import { ChevronLeft, ChevronRight } from "lucide-react"
import Link from "next/link"
import { motion, AnimatePresence } from "framer-motion"

export function CategoryShowcase() {
  const dispatch = useAppDispatch()
  const scrollContainerRef = useRef<HTMLDivElement>(null)
  const categories = useAppSelector((state: any) => state.categories.categories)
  const { language } = useAppSelector((state) => state.app)
  const [isVisible, setIsVisible] = useState(false)
  const usedIconsRef = useRef(new Set<string>())

  useEffect(() => {
    // Only fetch if not already loaded
    if (categories.length === 0) {
      dispatch(fetchCategories())
    }
  }, [dispatch, categories.length])

  useEffect(() => {
    // Trigger animation when categories are loaded
    if (categories.length > 0) {
      setIsVisible(true)
    }
  }, [categories])

  const scroll = (direction: 'left' | 'right') => {
    if (!scrollContainerRef.current) return
    const scrollAmount = 320
    scrollContainerRef.current.scrollBy({
      left: direction === 'left' ? -scrollAmount : scrollAmount,
      behavior: 'smooth'
    })
  }

  // Reset used icons when categories change
  useEffect(() => {
    usedIconsRef.current.clear()
  }, [categories])
  
  // Unique icon mapping - each category gets a different icon
  const iconMap: { [key: string]: { icon: string, gradient: string } } = {
    // Apparel
    't-shirt': { icon: "üëï", gradient: "from-blue-500/20 to-purple-500/20" },
    'hoodie': { icon: "üß•", gradient: "from-gray-500/20 to-blue-500/20" },
    'cap': { icon: "üß¢", gradient: "from-green-500/20 to-teal-500/20" },
    'jacket': { icon: "üß§", gradient: "from-indigo-500/20 to-blue-500/20" },
    'pants': { icon: "üëñ", gradient: "from-blue-500/20 to-slate-500/20" },
    'dress': { icon: "üëó", gradient: "from-pink-500/20 to-purple-500/20" },
    'shoe': { icon: "üëü", gradient: "from-red-500/20 to-orange-500/20" },
    'sock': { icon: "üß¶", gradient: "from-yellow-500/20 to-orange-500/20" },
    
    // Drinkware
    'mug': { icon: "‚òï", gradient: "from-orange-500/20 to-amber-500/20" },
    'bottle': { icon: "ü•§", gradient: "from-cyan-500/20 to-blue-500/20" },
    'tumbler': { icon: "üçµ", gradient: "from-green-500/20 to-teal-500/20" },
    'glass': { icon: "ü•É", gradient: "from-purple-500/20 to-pink-500/20" },
    
    // Bags
    'bag': { icon: "üéí", gradient: "from-purple-500/20 to-pink-500/20" },
    'tote': { icon: "üëú", gradient: "from-pink-500/20 to-purple-500/20" },
    'wallet': { icon: "üíº", gradient: "from-amber-500/20 to-orange-500/20" },
    
    // Accessories
    'watch': { icon: "‚åö", gradient: "from-gray-500/20 to-blue-500/20" },
    'jewelry': { icon: "üíé", gradient: "from-purple-500/20 to-cyan-500/20" },
    'sunglasses': { icon: "üï∂Ô∏è", gradient: "from-gray-800/20 to-gray-600/20" },
    'belt': { icon: "üéóÔ∏è", gradient: "from-brown-500/20 to-amber-500/20" },
    'accessories': { icon: "üíç", gradient: "from-yellow-500/20 to-pink-500/20" },
    
    // Print Products
    'sticker': { icon: "üåü", gradient: "from-pink-500/20 to-purple-500/20" },
    'poster': { icon: "üñºÔ∏è", gradient: "from-teal-500/20 to-cyan-500/20" },
    'business card': { icon: "ü™™", gradient: "from-slate-500/20 to-gray-500/20" },
    'flyer': { icon: "üìã", gradient: "from-blue-500/20 to-indigo-500/20" },
    'banner': { icon: "üéè", gradient: "from-red-500/20 to-orange-500/20" },
    'sign': { icon: "üö¶", gradient: "from-yellow-500/20 to-amber-500/20" },
    'label': { icon: "üè∑Ô∏è", gradient: "from-green-500/20 to-emerald-500/20" },
    'calendar': { icon: "üìÖ", gradient: "from-red-500/20 to-pink-500/20" },
    'invitation': { icon: "üíå", gradient: "from-pink-500/20 to-red-500/20" },
    
    // Office
    'pen': { icon: "üñäÔ∏è", gradient: "from-gray-500/20 to-slate-500/20" },
    'notebook': { icon: "üìî", gradient: "from-indigo-500/20 to-purple-500/20" },
    'folder': { icon: "üìÅ", gradient: "from-yellow-500/20 to-amber-500/20" },
    'office': { icon: "üóÇÔ∏è", gradient: "from-gray-500/20 to-blue-500/20" },
    'stamp': { icon: "üìÆ", gradient: "from-red-500/20 to-pink-500/20" },
    
    // Tech
    'phone': { icon: "üì±", gradient: "from-blue-500/20 to-purple-500/20" },
    'laptop': { icon: "üíª", gradient: "from-gray-500/20 to-slate-500/20" },
    'tablet': { icon: "üì≤", gradient: "from-cyan-500/20 to-blue-500/20" },
    'usb': { icon: "üíø", gradient: "from-purple-500/20 to-pink-500/20" },
    'charger': { icon: "üîå", gradient: "from-yellow-500/20 to-orange-500/20" },
    'headphone': { icon: "üéß", gradient: "from-blue-500/20 to-cyan-500/20" },
    'mouse': { icon: "üñ±Ô∏è", gradient: "from-slate-500/20 to-gray-500/20" },
    'keyboard': { icon: "‚å®Ô∏è", gradient: "from-gray-600/20 to-gray-800/20" },
    'speaker': { icon: "üîä", gradient: "from-red-500/20 to-orange-500/20" },
    'tech': { icon: "üîß", gradient: "from-gray-500/20 to-blue-500/20" },
    
    // Home
    'home': { icon: "üè†", gradient: "from-green-500/20 to-blue-500/20" },
    'kitchen': { icon: "üç≥", gradient: "from-orange-500/20 to-red-500/20" },
    'pillow': { icon: "üõèÔ∏è", gradient: "from-purple-500/20 to-pink-500/20" },
    'towel': { icon: "üßª", gradient: "from-blue-500/20 to-cyan-500/20" },
    'blanket': { icon: "üõãÔ∏è", gradient: "from-gray-500/20 to-brown-500/20" },
    'candle': { icon: "üïØÔ∏è", gradient: "from-yellow-500/20 to-orange-500/20" },
    
    // Promotional
    'gift': { icon: "üéÅ", gradient: "from-red-500/20 to-pink-500/20" },
    'promotional': { icon: "üì¢", gradient: "from-purple-500/20 to-blue-500/20" },
    'award': { icon: "üèÜ", gradient: "from-yellow-500/20 to-amber-500/20" },
    'medal': { icon: "ü•á", gradient: "from-gold-500/20 to-yellow-500/20" },
    'certificate': { icon: "üìú", gradient: "from-amber-500/20 to-yellow-500/20" },
    
    // Packaging
    'box': { icon: "üì¶", gradient: "from-amber-500/20 to-orange-500/20" },
    'envelope': { icon: "‚úâÔ∏è", gradient: "from-blue-500/20 to-cyan-500/20" },
    'wrap': { icon: "üéÄ", gradient: "from-pink-500/20 to-purple-500/20" },
    
    // Events
    'party': { icon: "üéâ", gradient: "from-purple-500/20 to-pink-500/20" },
    'wedding': { icon: "üíí", gradient: "from-pink-500/20 to-purple-500/20" },
    'birthday': { icon: "üéÇ", gradient: "from-yellow-500/20 to-pink-500/20" },
    'christmas': { icon: "üéÑ", gradient: "from-green-500/20 to-red-500/20" },
    'graduation': { icon: "üéì", gradient: "from-blue-500/20 to-purple-500/20" },
    'baby': { icon: "üë∂", gradient: "from-blue-300/20 to-pink-300/20" },
    'event': { icon: "üé™", gradient: "from-red-500/20 to-yellow-500/20" },
    
    // Sports
    'sport': { icon: "‚öΩ", gradient: "from-green-500/20 to-blue-500/20" },
    'gym': { icon: "üí™", gradient: "from-red-500/20 to-orange-500/20" },
    'yoga': { icon: "üßò", gradient: "from-purple-500/20 to-pink-500/20" },
    'outdoor': { icon: "‚õ∫", gradient: "from-green-500/20 to-teal-500/20" },
    'travel': { icon: "‚úàÔ∏è", gradient: "from-blue-500/20 to-cyan-500/20" },
    'beach': { icon: "üèñÔ∏è", gradient: "from-yellow-500/20 to-blue-500/20" },
    
    // Food
    'food': { icon: "üçï", gradient: "from-red-500/20 to-yellow-500/20" },
    'beverage': { icon: "üçπ", gradient: "from-blue-500/20 to-cyan-500/20" },
    'restaurant': { icon: "üçΩÔ∏è", gradient: "from-orange-500/20 to-red-500/20" },
    
    // Other
    'kid': { icon: "üß∏", gradient: "from-yellow-500/20 to-pink-500/20" },
    'game': { icon: "üéÆ", gradient: "from-purple-500/20 to-blue-500/20" },
    'pet': { icon: "üêæ", gradient: "from-brown-500/20 to-orange-500/20" },
    'health': { icon: "üè•", gradient: "from-red-500/20 to-white/20" },
    'beauty': { icon: "üíÑ", gradient: "from-pink-500/20 to-purple-500/20" },
    'spa': { icon: "üßñ", gradient: "from-green-500/20 to-blue-500/20" },
    'car': { icon: "üöó", gradient: "from-gray-500/20 to-blue-500/20" },
    'music': { icon: "üéµ", gradient: "from-purple-500/20 to-pink-500/20" },
    'movie': { icon: "üé¨", gradient: "from-red-500/20 to-orange-500/20" },
    'marketing': { icon: "üìà", gradient: "from-blue-500/20 to-green-500/20" },
    'custom': { icon: "‚ú®", gradient: "from-purple-500/20 via-pink-500/20 to-yellow-500/20" },
    'eco': { icon: "‚ôªÔ∏è", gradient: "from-green-500/20 to-emerald-500/20" },
    'luxury': { icon: "üëë", gradient: "from-gold-500/20 to-yellow-500/20" },
  }
  
  // Additional unique icons to use as fallbacks
  const fallbackIcons = [
    "üé®", "üé≠", "üåà", "üí´", "üîÆ", "üéØ", "üé≤", "üé∏", "üé∫", "üéª",
    "üèà", "üèÄ", "üéæ", "üèê", "ü•ä", "üé≥", "üèπ", "üé£", "üéø", "üèÇ",
    "üåç", "üåé", "üåè", "üå∏", "üå∫", "üåª", "üå∑", "üåπ", "üå¥", "üçÄ",
    "üî•", "üíß", "‚ö°", "‚ùÑÔ∏è", "üåô", "‚≠ê", "üåû", "‚òÅÔ∏è", "üåä", "üçÇ"
  ]
  
  let fallbackIndex = 0
  
  // Unique icon for each category - no duplicates
  const getCategoryStyle = (categoryName: string) => {
    const name = categoryName.toLowerCase()
    
    // Check if we already assigned an icon to this exact category
    for (const [key, value] of Object.entries(iconMap)) {
      if (name.includes(key) && !usedIconsRef.current.has(value.icon)) {
        usedIconsRef.current.add(value.icon)
        return value
      }
    }
    
    // If no match found or icon already used, assign a fallback icon
    for (const icon of fallbackIcons) {
      if (!usedIconsRef.current.has(icon)) {
        usedIconsRef.current.add(icon)
        return { icon, gradient: "from-gray-500/20 to-slate-500/20" }
      }
    }
    
    // Ultimate fallback
    return { icon: "üõçÔ∏è", gradient: "from-gray-500/20 to-slate-500/20" }
  }

  const activeCategories = categories.filter((cat: any) => cat.isActive)

  // Container animation
  const containerVariants = {
      return { icon: getUniqueIcon("üß•", ["ü•º", "ü¶∫", "üß§"]), gradient: "from-indigo-500/20 to-blue-500/20" }
    }
    if (name.includes('pants') || name.includes('trousers') || name.includes('jeans')) {
      return { icon: getUniqueIcon("üëñ", ["ü©≥", "ü©≤", "ü•æ"]), gradient: "from-blue-500/20 to-slate-500/20" }
    }
    if (name.includes('dress') || name.includes('skirt')) {
      return { icon: getUniqueIcon("üëó", ["üëò", "ü•ª", "üëö"]), gradient: "from-pink-500/20 to-purple-500/20" }
    }
    if (name.includes('shoe') || name.includes('sneaker') || name.includes('footwear')) {
      return { icon: getUniqueIcon("üëü", ["üëû", "üë†", "ü•æ", "üë¢", "ü©¥"]), gradient: "from-red-500/20 to-orange-500/20" }
    }
    if (name.includes('sock')) {
      return { icon: getUniqueIcon("üß¶", ["ü¶∂", "ü©¥", "üë£"]), gradient: "from-yellow-500/20 to-orange-500/20" }
    }
    
    // Drinkware variety
    if (name.includes('mug') || name.includes('cup') || name.includes('coffee')) {
      return { icon: getUniqueIcon("‚òï", ["üçµ", "ü•§", "üßÉ", "üßã"]), gradient: "from-orange-500/20 to-amber-500/20" }
    }
    if (name.includes('bottle') || name.includes('water')) {
      return { icon: getUniqueIcon("ü•§", ["üç∂", "üçº", "üß¥", "üßÉ"]), gradient: "from-cyan-500/20 to-blue-500/20" }
    }
    if (name.includes('tumbler') || name.includes('thermos')) {
      return { icon: getUniqueIcon("üçµ", ["‚òï", "ü•õ", "üßâ"]), gradient: "from-green-500/20 to-teal-500/20" }
    }
    if (name.includes('glass') || name.includes('wine')) {
      return { icon: getUniqueIcon("ü•É", ["üç∑", "üç∏", "üçπ", "ü•Ç"]), gradient: "from-purple-500/20 to-pink-500/20" }
    }
    
    // Bags & Accessories expanded
    if (name.includes('bag') || name.includes('backpack')) {
      return { icon: "üéí", gradient: "from-purple-500/20 to-pink-500/20" }
    }
    if (name.includes('tote')) {
      return { icon: "üëú", gradient: "from-pink-500/20 to-purple-500/20" }
    }
    if (name.includes('wallet') || name.includes('purse')) {
      return { icon: "üíº", gradient: "from-amber-500/20 to-orange-500/20" }
    }
    if (name.includes('watch') || name.includes('timepiece')) {
      return { icon: "‚åö", gradient: "from-gray-500/20 to-blue-500/20" }
    }
    if (name.includes('jewelry') || name.includes('necklace')) {
      return { icon: "üíé", gradient: "from-purple-500/20 to-cyan-500/20" }
    }
    if (name.includes('sunglasses') || name.includes('eyewear')) {
      return { icon: "üï∂Ô∏è", gradient: "from-gray-800/20 to-gray-600/20" }
    }
    if (name.includes('belt')) {
      return { icon: "üéóÔ∏è", gradient: "from-brown-500/20 to-amber-500/20" }
    }
    if (name.includes('accessories') || name.includes('accessory')) {
      return { icon: "üíç", gradient: "from-yellow-500/20 to-pink-500/20" }
    }
    
    // Print Products variety
    if (name.includes('sticker') || name.includes('decal')) {
      return { icon: "üåü", gradient: "from-pink-500/20 to-purple-500/20" }
    }
    if (name.includes('poster') || name.includes('print')) {
      return { icon: "üñºÔ∏è", gradient: "from-teal-500/20 to-cyan-500/20" }
    }
    if (name.includes('business card') || name === 'cards') {
      return { icon: "ü™™", gradient: "from-slate-500/20 to-gray-500/20" }
    }
    if (name.includes('flyer') || name.includes('brochure')) {
      return { icon: "üìã", gradient: "from-blue-500/20 to-indigo-500/20" }
    }
    if (name.includes('banner')) {
      return { icon: "üéè", gradient: "from-red-500/20 to-orange-500/20" }
    }
    if (name.includes('sign') || name.includes('signage')) {
      return { icon: "üö¶", gradient: "from-yellow-500/20 to-amber-500/20" }
    }
    if (name.includes('label') || name.includes('tag')) {
      return { icon: "üè∑Ô∏è", gradient: "from-green-500/20 to-emerald-500/20" }
    }
    if (name.includes('calendar')) {
      return { icon: "üìÖ", gradient: "from-red-500/20 to-pink-500/20" }
    }
    if (name.includes('invitation')) {
      return { icon: "üíå", gradient: "from-pink-500/20 to-red-500/20" }
    }
    
    // Office & Business expanded
    if (name.includes('pen') || name.includes('writing')) {
      return { icon: "üñäÔ∏è", gradient: "from-gray-500/20 to-slate-500/20" }
    }
    if (name.includes('notebook') || name.includes('journal')) {
      return { icon: "üìî", gradient: "from-indigo-500/20 to-purple-500/20" }
    }
    if (name.includes('folder') || name.includes('binder')) {
      return { icon: "üìÅ", gradient: "from-yellow-500/20 to-amber-500/20" }
    }
    if (name.includes('desk') || name.includes('office')) {
      return { icon: "üóÇÔ∏è", gradient: "from-gray-500/20 to-blue-500/20" }
    }
    if (name.includes('stamp') || name.includes('seal')) {
      return { icon: "üìÆ", gradient: "from-red-500/20 to-pink-500/20" }
    }
    
    // Tech & Electronics expanded
    if (name.includes('phone') || name.includes('mobile') || name.includes('case')) {
      return { icon: "üì±", gradient: "from-blue-500/20 to-purple-500/20" }
    }
    if (name.includes('laptop') || name.includes('computer')) {
      return { icon: "üíª", gradient: "from-gray-500/20 to-slate-500/20" }
    }
    if (name.includes('tablet') || name.includes('ipad')) {
      return { icon: "üì≤", gradient: "from-cyan-500/20 to-blue-500/20" }
    }
    if (name.includes('usb') || name.includes('flash')) {
      return { icon: "üíø", gradient: "from-purple-500/20 to-pink-500/20" }
    }
    if (name.includes('charger') || name.includes('cable')) {
      return { icon: "üîå", gradient: "from-yellow-500/20 to-orange-500/20" }
    }
    if (name.includes('headphone') || name.includes('earphone')) {
      return { icon: "üéß", gradient: "from-blue-500/20 to-cyan-500/20" }
    }
    if (name.includes('mouse') || name.includes('mousepad')) {
      return { icon: "üñ±Ô∏è", gradient: "from-slate-500/20 to-gray-500/20" }
    }
    if (name.includes('keyboard')) {
      return { icon: "‚å®Ô∏è", gradient: "from-gray-600/20 to-gray-800/20" }
    }
    if (name.includes('speaker') || name.includes('audio')) {
      return { icon: "üîä", gradient: "from-red-500/20 to-orange-500/20" }
    }
    if (name.includes('tech') || name.includes('gadget')) {
      return { icon: "üîß", gradient: "from-gray-500/20 to-blue-500/20" }
    }
    
    // Home & Living
    if (name.includes('home') || name.includes('house')) {
      return { icon: "üè†", gradient: "from-green-500/20 to-blue-500/20" }
    }
    if (name.includes('kitchen')) {
      return { icon: "üç≥", gradient: "from-orange-500/20 to-red-500/20" }
    }
    if (name.includes('pillow') || name.includes('cushion')) {
      return { icon: "üõèÔ∏è", gradient: "from-purple-500/20 to-pink-500/20" }
    }
    if (name.includes('towel')) {
      return { icon: "üßª", gradient: "from-blue-500/20 to-cyan-500/20" }
    }
    if (name.includes('blanket') || name.includes('throw')) {
      return { icon: "üõãÔ∏è", gradient: "from-gray-500/20 to-brown-500/20" }
    }
    if (name.includes('candle')) {
      return { icon: "üïØÔ∏è", gradient: "from-yellow-500/20 to-orange-500/20" }
    }
    
    // Promotional & Gift expanded
    if (name.includes('gift') || name.includes('present')) {
      return { icon: "üéÅ", gradient: "from-red-500/20 to-pink-500/20" }
    }
    if (name.includes('promotional') || name.includes('promo')) {
      return { icon: "üì¢", gradient: "from-purple-500/20 to-blue-500/20" }
    }
    if (name.includes('award') || name.includes('trophy')) {
      return { icon: "üèÜ", gradient: "from-yellow-500/20 to-amber-500/20" }
    }
    if (name.includes('medal') || name.includes('badge')) {
      return { icon: "ü•á", gradient: "from-gold-500/20 to-yellow-500/20" }
    }
    if (name.includes('certificate')) {
      return { icon: "üìú", gradient: "from-amber-500/20 to-yellow-500/20" }
    }
    
    // Packaging variety
    if (name.includes('box') || name.includes('package')) {
      return { icon: "üì¶", gradient: "from-amber-500/20 to-orange-500/20" }
    }
    if (name.includes('envelope')) {
      return { icon: "‚úâÔ∏è", gradient: "from-blue-500/20 to-cyan-500/20" }
    }
    if (name.includes('wrap') || name.includes('wrapping')) {
      return { icon: "üéÄ", gradient: "from-pink-500/20 to-purple-500/20" }
    }
    
    // Events expanded
    if (name.includes('party') || name.includes('celebration')) {
      return { icon: "üéâ", gradient: "from-purple-500/20 to-pink-500/20" }
    }
    if (name.includes('wedding')) {
      return { icon: "üíí", gradient: "from-pink-500/20 to-purple-500/20" }
    }
    if (name.includes('birthday')) {
      return { icon: "üéÇ", gradient: "from-yellow-500/20 to-pink-500/20" }
    }
    if (name.includes('christmas') || name.includes('holiday')) {
      return { icon: "üéÑ", gradient: "from-green-500/20 to-red-500/20" }
    }
    if (name.includes('graduation')) {
      return { icon: "üéì", gradient: "from-blue-500/20 to-purple-500/20" }
    }
    if (name.includes('baby') || name.includes('shower')) {
      return { icon: "üë∂", gradient: "from-blue-300/20 to-pink-300/20" }
    }
    if (name.includes('event')) {
      return { icon: "üé™", gradient: "from-red-500/20 to-yellow-500/20" }
    }
    
    // Sports & Outdoor expanded
    if (name.includes('sport') || name.includes('fitness')) {
      return { icon: "‚öΩ", gradient: "from-green-500/20 to-blue-500/20" }
    }
    if (name.includes('gym') || name.includes('workout')) {
      return { icon: "üí™", gradient: "from-red-500/20 to-orange-500/20" }
    }
    if (name.includes('yoga')) {
      return { icon: "üßò", gradient: "from-purple-500/20 to-pink-500/20" }
    }
    if (name.includes('outdoor') || name.includes('camping')) {
      return { icon: "‚õ∫", gradient: "from-green-500/20 to-teal-500/20" }
    }
    if (name.includes('travel') || name.includes('luggage')) {
      return { icon: "‚úàÔ∏è", gradient: "from-blue-500/20 to-cyan-500/20" }
    }
    if (name.includes('beach') || name.includes('summer')) {
      return { icon: "üèñÔ∏è", gradient: "from-yellow-500/20 to-blue-500/20" }
    }
    
    // Food & Beverage
    if (name.includes('food') || name.includes('snack')) {
      return { icon: "üçï", gradient: "from-red-500/20 to-yellow-500/20" }
    }
    if (name.includes('beverage') || name.includes('drink')) {
      return { icon: "ü•§", gradient: "from-blue-500/20 to-cyan-500/20" }
    }
    if (name.includes('restaurant') || name.includes('cafe')) {
      return { icon: "üçΩÔ∏è", gradient: "from-orange-500/20 to-red-500/20" }
    }
    
    // Kids & Toys
    if (name.includes('kid') || name.includes('child') || name.includes('toy')) {
      return { icon: "üß∏", gradient: "from-yellow-500/20 to-pink-500/20" }
    }
    if (name.includes('game') || name.includes('puzzle')) {
      return { icon: "üéÆ", gradient: "from-purple-500/20 to-blue-500/20" }
    }
    
    // Pet Products
    if (name.includes('pet') || name.includes('dog') || name.includes('cat')) {
      return { icon: "üêæ", gradient: "from-brown-500/20 to-orange-500/20" }
    }
    
    // Health & Beauty
    if (name.includes('health') || name.includes('medical')) {
      return { icon: "üè•", gradient: "from-red-500/20 to-white/20" }
    }
    if (name.includes('beauty') || name.includes('cosmetic')) {
      return { icon: "üíÑ", gradient: "from-pink-500/20 to-purple-500/20" }
    }
    if (name.includes('spa') || name.includes('wellness')) {
      return { icon: "üßñ", gradient: "from-green-500/20 to-blue-500/20" }
    }
    
    // Automotive
    if (name.includes('car') || name.includes('auto') || name.includes('vehicle')) {
      return { icon: "üöó", gradient: "from-gray-500/20 to-blue-500/20" }
    }
    
    // Music & Entertainment
    if (name.includes('music') || name.includes('band')) {
      return { icon: "üéµ", gradient: "from-purple-500/20 to-pink-500/20" }
    }
    if (name.includes('movie') || name.includes('film')) {
      return { icon: "üé¨", gradient: "from-red-500/20 to-orange-500/20" }
    }
    
    // Marketing & Advertising
    if (name.includes('marketing') || name.includes('advertising')) {
      return { icon: "üìà", gradient: "from-blue-500/20 to-green-500/20" }
    }
    if (name.includes('social') || name.includes('media')) {
      return { icon: "üì±", gradient: "from-purple-500/20 to-pink-500/20" }
    }
    
    // Custom & Special
    if (name.includes('custom') || name.includes('personalized')) {
      return { icon: "‚ú®", gradient: "from-purple-500/20 via-pink-500/20 to-yellow-500/20" }
    }
    if (name.includes('eco') || name.includes('sustainable')) {
      return { icon: "‚ôªÔ∏è", gradient: "from-green-500/20 to-emerald-500/20" }
    }
    if (name.includes('luxury') || name.includes('premium')) {
      return { icon: "üëë", gradient: "from-gold-500/20 to-yellow-500/20" }
    }
    
    // Default fallback
    return { icon: "üõçÔ∏è", gradient: "from-gray-500/20 to-slate-500/20" }
  }

  const activeCategories = categories.filter((cat: any) => cat.isActive)

  // Container animation
  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.03,
        delayChildren: 0.1
      }
    }
  }

  // Item animation
  const itemVariants = {
    hidden: { 
      opacity: 0, 
      y: 30,
      scale: 0.9
    },
    visible: { 
      opacity: 1, 
      y: 0,
      scale: 1,
      transition: {
        type: "spring",
        stiffness: 100,
        damping: 15
      }
    }
  }

  // Show placeholder while loading
  if (!isVisible) {
    return (
      <div className="w-full py-8 relative">
        <div className="container mx-auto px-4 relative">
          <div className="flex items-center justify-center h-32">
            <div className="flex gap-8">
              {[...Array(6)].map((_, i) => (
                <div key={i} className="animate-pulse">
                  <div className="w-24 h-24 rounded-2xl bg-gray-200 dark:bg-gray-700"></div>
                  <div className="w-20 h-4 mt-3 rounded bg-gray-200 dark:bg-gray-700"></div>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    )
  }

  return (
    <AnimatePresence>
      <motion.div 
        className="w-full py-4 relative"
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        transition={{ duration: 0.3 }}
      >
        <div className="container mx-auto px-4 relative">
          <div className="flex items-center">
            {/* Left scroll button */}
            <motion.button
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.5 }}
              onClick={() => scroll('left')}
              className="absolute left-2 z-10 w-10 h-10 rounded-full bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm shadow-lg flex items-center justify-center hover:bg-white dark:hover:bg-gray-800 hover:scale-110 active:scale-95 transition-all duration-200"
            >
              <ChevronLeft className="h-5 w-5 text-gray-700 dark:text-gray-300" />
            </motion.button>

            {/* Scrollable container */}
            <motion.div 
              ref={scrollContainerRef}
              className="flex gap-8 overflow-x-auto scrollbar-hide scroll-smooth px-14"
              style={{ 
                scrollbarWidth: 'none', 
                msOverflowStyle: 'none',
                WebkitScrollbar: { display: 'none' }
              }}
              variants={containerVariants}
              initial="hidden"
              animate="visible"
            >
              {/* Category items */}
              {activeCategories.map((category: any) => {
                const style = getCategoryStyle(category.name)
                
                return (
                  <motion.div 
                    key={category.id}
                    variants={itemVariants}
                  >
                    <Link
                      href={`/products?category=${category.slug}`}
                      className="group flex flex-col items-center gap-3 cursor-pointer"
                    >
                      <motion.div 
                        className="relative"
                        whileHover={{ scale: 1.08 }}
                        whileTap={{ scale: 0.95 }}
                        transition={{ type: "spring", stiffness: 400, damping: 17 }}
                      >
                        <div className={`w-24 h-24 rounded-2xl bg-gradient-to-br ${style.gradient} backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300`}>
                          <span className="text-4xl filter drop-shadow-sm">{style.icon}</span>
                        </div>
                      </motion.div>
                      <span className="text-sm font-semibold text-gray-700 dark:text-gray-300 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors text-center max-w-[100px]">
                        {category.name}
                      </span>
                    </Link>
                  </motion.div>
                )
              })}
            </motion.div>

            {/* Right scroll button */}
            <motion.button
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: 0.5 }}
              onClick={() => scroll('right')}
              className="absolute right-2 z-10 w-10 h-10 rounded-full bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm shadow-lg flex items-center justify-center hover:bg-white dark:hover:bg-gray-800 hover:scale-110 active:scale-95 transition-all duration-200"
            >
              <ChevronRight className="h-5 w-5 text-gray-700 dark:text-gray-300" />
            </motion.button>
          </div>

          {/* Visual hint for scrolling */}
          <motion.div 
            className="flex justify-center mt-6 gap-1"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.8 }}
          >
            {[...Array(Math.min(5, Math.ceil(activeCategories.length / 4)))].map((_, i) => (
              <div 
                key={i}
                className="w-1.5 h-1.5 rounded-full bg-gray-300 dark:bg-gray-600"
              />
            ))}
          </motion.div>
        </div>
      </motion.div>
    </AnimatePresence>
  )
}